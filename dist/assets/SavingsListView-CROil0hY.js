import{r as A,B as P,R as J,o as K,S as Y,c as u,b as t,d as Z,w as ee,g as te,y as L,z as re,e as D,D as ne,x as se,F,l as R,t as g,q as C,M as oe,m as f,n as ae}from"./index-CHW42hPp.js";import{u as ie}from"./toast-DZktrDzS.js";var O=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function le(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}function de(e){var o=typeof e;return e!=null&&(o=="object"||o=="function")}var q=de,ce=typeof O=="object"&&O&&O.Object===Object&&O,ue=ce,ge=ue,fe=typeof self=="object"&&self&&self.Object===Object&&self,pe=ge||fe||Function("return this")(),H=pe,me=H,ve=function(){return me.Date.now()},ye=ve,be=/\s/;function xe(e){for(var o=e.length;o--&&be.test(e.charAt(o)););return o}var he=xe,we=he,_e=/^\s+/;function Te(e){return e&&e.slice(0,we(e)+1).replace(_e,"")}var Se=Te,ke=H,je=ke.Symbol,X=je,B=X,Q=Object.prototype,$e=Q.hasOwnProperty,Pe=Q.toString,S=B?B.toStringTag:void 0;function Ce(e){var o=$e.call(e,S),l=e[S];try{e[S]=void 0;var p=!0}catch{}var c=Pe.call(e);return p&&(o?e[S]=l:delete e[S]),c}var Oe=Ce,Ie=Object.prototype,Ee=Ie.toString;function Ae(e){return Ee.call(e)}var Ne=Ae,V=X,Me=Oe,Le=Ne,De="[object Null]",Fe="[object Undefined]",z=V?V.toStringTag:void 0;function Re(e){return e==null?e===void 0?Fe:De:z&&z in Object(e)?Me(e):Le(e)}var Be=Re;function Ve(e){return e!=null&&typeof e=="object"}var ze=Ve,Ge=Be,Ue=ze,We="[object Symbol]";function qe(e){return typeof e=="symbol"||Ue(e)&&Ge(e)==We}var He=qe,Xe=Se,G=q,Qe=He,U=NaN,Je=/^[-+]0x[0-9a-f]+$/i,Ke=/^0b[01]+$/i,Ye=/^0o[0-7]+$/i,Ze=parseInt;function et(e){if(typeof e=="number")return e;if(Qe(e))return U;if(G(e)){var o=typeof e.valueOf=="function"?e.valueOf():e;e=G(o)?o+"":o}if(typeof e!="string")return e===0?e:+e;e=Xe(e);var l=Ke.test(e);return l||Ye.test(e)?Ze(e.slice(2),l?2:8):Je.test(e)?U:+e}var tt=et,rt=q,N=ye,W=tt,nt="Expected a function",st=Math.max,ot=Math.min;function at(e,o,l){var p,c,m,v,d,y,a=0,_=!1,x=!1,h=!0;if(typeof e!="function")throw new TypeError(nt);o=W(o)||0,rt(l)&&(_=!!l.leading,x="maxWait"in l,m=x?st(W(l.maxWait)||0,o):m,h="trailing"in l?!!l.trailing:h);function T(i){var n=p,w=c;return p=c=void 0,a=i,v=e.apply(w,n),v}function I(i){return a=i,d=setTimeout(b,o),_?T(i):v}function E(i){var n=i-y,w=i-a,M=o-n;return x?ot(M,m-w):M}function k(i){var n=i-y,w=i-a;return y===void 0||n>=o||n<0||x&&w>=m}function b(){var i=N();if(k(i))return j(i);d=setTimeout(b,E(i))}function j(i){return d=void 0,h&&p?T(i):(p=c=void 0,v)}function $(){d!==void 0&&clearTimeout(d),a=0,p=y=c=d=void 0}function s(){return d===void 0?v:j(N())}function r(){var i=N(),n=k(i);if(p=arguments,c=this,y=i,n){if(d===void 0)return I(y);if(x)return clearTimeout(d),d=setTimeout(b,o),T(y)}return d===void 0&&(d=setTimeout(b,o)),v}return r.cancel=$,r.flush=s,r}var it=at;const lt=le(it),dt={class:"flex justify-between items-center mb-4"},ct={class:"bg-white rounded-lg shadow-sm p-3 mb-4"},ut={class:"grid grid-cols-1 md:grid-cols-3 gap-3"},gt={class:"col-span-2"},ft={class:"relative"},pt={class:"bg-white shadow-sm rounded-lg overflow-hidden border border-gray-200"},mt={key:0,class:"p-4 text-center text-gray-500"},vt={key:1,class:"p-4 text-center text-gray-500"},yt={key:2,class:"overflow-x-auto"},bt={class:"min-w-full divide-y divide-gray-200"},xt={class:"bg-white divide-y divide-gray-200"},ht=["onClick"],wt={class:"py-3 px-4 whitespace-nowrap"},_t={class:"text-xs font-medium text-gray-600"},Tt={class:"text-xs text-gray-500"},St={class:"py-3 px-4 whitespace-nowrap"},kt={class:"text-xs font-medium text-gray-600"},jt={class:"py-3 px-4 whitespace-nowrap"},$t={class:"text-xs font-medium text-gray-600"},Pt={class:"py-3 px-4 whitespace-nowrap"},Ct={class:"text-xs font-medium text-gray-600"},Ot={class:"py-3 px-4 whitespace-nowrap"},It={key:3,class:"mt-4 flex justify-between items-center bg-white px-4 py-3 border-t border-gray-200"},Et={class:"text-xs text-gray-700"},At={class:"flex space-x-1"},Nt=["disabled"],Mt=["onClick"],Lt={key:1,class:"px-2 py-1 text-xs"},Dt=["disabled"],Bt={__name:"SavingsListView",setup(e){const o=J(),l=ie(),p=oe(),c=A(""),m=A({status:"",search:""}),v=P(()=>o.getters["savings/getAccounts"]),d=P(()=>o.getters["savings/isLoading"]),y=P(()=>o.getters["savings/getError"]),a=P(()=>o.getters["savings/getPagination"]);K(async()=>{await _(),document.addEventListener("click",$);const s=document.createElement("style");s.textContent=`
    .dropdown-menu-fixed {
      position: fixed !important;
      z-index: 100 !important;
      overflow: visible !important;
      max-height: none !important;
    }
    
    .relative {
      position: relative !important;
    }
  `,document.head.appendChild(s)}),Y(()=>{document.removeEventListener("click",$)});const _=async()=>{try{await o.dispatch("savings/fetchAccounts",{page:1,perPage:10,search:c.value,status:m.value.status}),y.value&&l.error(y.value)}catch(s){console.error("Error refreshing accounts:",s),l.error("Une erreur est survenue lors du chargement des comptes d'épargne")}},x=lt(()=>{_()},500),h=async s=>{s<1||s>a.value.totalPages||await o.dispatch("savings/fetchAccounts",{page:s,perPage:a.value.perPage,search:c.value,status:m.value.status})},T=()=>{const s=a.value.currentPage,r=a.value.totalPages;return r<=7?Array.from({length:r},(i,n)=>n+1):s<=3?[1,2,3,4,"...",r]:s>=r-2?[1,"...",r-3,r-2,r-1,r]:[1,"...",s-1,s,s+1,"...",r]},I=s=>new Intl.NumberFormat("fr-FR",{style:"currency",currency:"XOF",minimumFractionDigits:0}).format(s||0),E=s=>s?new Date(s).toLocaleDateString("fr-FR",{day:"numeric",month:"short",year:"numeric"}):"N/A",k=s=>{switch(s){case"active":return"Actif";case"inactive":return"Inactif";case"closed":return"Clôturé";default:return s}},b=A(null),j=s=>{p.push(`/savings/${s}`)},$=s=>{if(b.value!==null){const r=document.querySelector(`[data-account-id="${b.value}"]`),i=document.querySelector(`[data-dropdown-button="${b.value}"]`);r&&i&&!r.contains(s.target)&&!i.contains(s.target)&&(b.value=null)}};return(s,r)=>{const i=te("router-link");return f(),u("div",null,[t("div",dt,[r[6]||(r[6]=t("h1",{class:"text-sm ml-1 tracking-widest font-medium text-gray-800"},"Comptes d'épargne",-1)),Z(i,{to:"/savings/new",class:"btn btn-primary flex items-center"},{default:ee(()=>r[5]||(r[5]=[t("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-4 w-4 mr-2",viewBox:"0 0 20 20",fill:"currentColor"},[t("path",{"fill-rule":"evenodd",d:"M10 5a1 1 0 011 1v3h3a1 1 0 110 2h-3v3a1 1 0 11-2 0v-3H6a1 1 0 110-2h3V6a1 1 0 011-1z","clip-rule":"evenodd"})],-1),ae(" Nouveau compte ")])),_:1})]),t("div",ct,[t("div",ut,[t("div",gt,[t("div",ft,[r[7]||(r[7]=t("div",{class:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none"},[t("svg",{class:"h-4 w-4 text-gray-400",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor"},[t("path",{"fill-rule":"evenodd",d:"M8 4a4 4 0 100 8 4 4 0 000-8zM2 8a6 6 0 1110.89 3.476l4.817 4.817a1 1 0 01-1.414 1.414l-4.816-4.816A6 6 0 012 8z","clip-rule":"evenodd"})])],-1)),L(t("input",{type:"text",class:"block w-[200px] text-xs pl-10 pr-3 py-1.5 border border-gray-300 rounded-md leading-5 bg-white placeholder-gray-500 focus:outline-none focus:ring-primary focus:border-primary",placeholder:"Rechercher","onUpdate:modelValue":r[0]||(r[0]=n=>c.value=n),onInput:r[1]||(r[1]=(...n)=>D(x)&&D(x)(...n))},null,544),[[re,c.value]])])]),t("div",null,[L(t("select",{id:"status-filter","onUpdate:modelValue":r[2]||(r[2]=n=>m.value.status=n),class:"block w-full text-xs text-gray-600 py-1.5 px-3 border border-gray-300 bg-white rounded-md shadow-sm focus:outline-none focus:ring-primary focus:border-primary",onChange:_},r[8]||(r[8]=[t("option",{value:""},"Tous les statuts",-1),t("option",{value:"active"},"Actif",-1),t("option",{value:"inactive"},"Inactif",-1),t("option",{value:"closed"},"Clôturé",-1)]),544),[[ne,m.value.status]])])])]),t("div",pt,[d.value?(f(),u("div",mt,r[9]||(r[9]=[t("svg",{class:"animate-spin h-5 w-5 mx-auto mb-2",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},[t("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"}),t("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})],-1),t("p",null,"Chargement des comptes d'épargne...",-1)]))):v.value.length===0?(f(),u("div",vt,r[10]||(r[10]=[t("p",null,"Aucun compte d'épargne trouvé.",-1)]))):(f(),u("div",yt,[t("table",bt,[r[11]||(r[11]=t("thead",{class:"bg-gray-50"},[t("tr",null,[t("th",{class:"py-3 px-4 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"N° Compte"),t("th",{class:"py-3 px-4 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Client associé"),t("th",{class:"py-3 px-4 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Solde"),t("th",{class:"py-3 px-4 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Taux d'intérêt"),t("th",{class:"py-3 px-4 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Statut")])],-1)),t("tbody",xt,[(f(!0),u(F,null,R(v.value,n=>(f(),u("tr",{key:n.id,class:"hover:bg-gray-50 cursor-pointer",onClick:w=>j(n.id)},[t("td",wt,[t("div",_t,g(n.account_number),1),t("div",Tt,g(E(n.opening_date)),1)]),t("td",St,[t("div",kt,g(n.client?`${n.client.first_name} ${n.client.last_name}`:"N/A"),1)]),t("td",jt,[t("div",$t,g(I(n.balance)),1)]),t("td",Pt,[t("div",Ct,g(n.interest_rate)+"%",1)]),t("td",Ot,[t("span",{class:C(["px-2 inline-flex text-xs leading-5 font-semibold rounded-full",{"bg-green-100 text-green-800":n.status==="active","bg-yellow-100 text-yellow-800":n.status==="inactive","bg-red-100 text-red-800":n.status==="closed"}])},g(k(n.status)),3)])],8,ht))),128))])])])),v.value.length>0?(f(),u("div",It,[t("div",Et," Affichage de "+g((a.value.currentPage-1)*a.value.perPage+1)+" à "+g(Math.min(a.value.currentPage*a.value.perPage,a.value.totalItems))+" sur "+g(a.value.totalItems)+" résultats ",1),t("div",At,[t("button",{onClick:r[3]||(r[3]=n=>h(a.value.currentPage-1)),disabled:a.value.currentPage===1,class:C([a.value.currentPage===1?"opacity-50 cursor-not-allowed":"","px-3 py-1 text-xs border border-gray-300 rounded-md hover:bg-gray-100"])}," Précédent ",10,Nt),(f(!0),u(F,null,R(T(),n=>(f(),u("div",{key:n},[n!=="..."?(f(),u("button",{key:0,onClick:w=>h(n),class:C([a.value.currentPage===n?"bg-primary text-white":"bg-white text-gray-700 hover:bg-gray-100","px-3 py-1 text-xs border border-gray-300 rounded-md"])},g(n),11,Mt)):(f(),u("span",Lt,g(n),1))]))),128)),t("button",{onClick:r[4]||(r[4]=n=>h(a.value.currentPage+1)),disabled:a.value.currentPage===a.value.totalPages,class:C([a.value.currentPage===a.value.totalPages?"opacity-50 cursor-not-allowed":"","px-3 py-1 text-xs border border-gray-300 rounded-md hover:bg-gray-100"])}," Suivant ",10,Dt)])])):se("",!0)]),r[12]||(r[12]=t("div",{id:"dropdown-portal"},null,-1))])}}};export{Bt as default};
