import{_ as E,B as N,L as R,r as u,o as H,K as C,a as j,c as l,b as e,x as w,d as f,w as g,g as T,t as n,q as b,n as i,F as M,l as $,k as P,M as q,m as o}from"./index-CHW42hPp.js";const U={class:"flex items-center justify-between mb-6"},K={class:"flex items-center"},X={class:"flex space-x-2"},G={key:0,class:"bg-white rounded-lg shadow-sm p-6 text-center"},J={key:1,class:"bg-white rounded-lg shadow-sm p-6"},O={class:"text-gray-600"},Q={key:2,class:"grid grid-cols-1 md:grid-cols-3 gap-6"},W={class:"bg-white rounded-lg shadow-sm overflow-hidden"},Y={class:"p-6"},Z={class:"flex items-center mb-4"},ee={class:"flex-shrink-0 h-14 w-14 bg-primary bg-opacity-10 rounded-full flex items-center justify-center"},te={class:"text-primary text-lg font-medium"},se={class:"ml-4"},re={class:"text-sm mb-3 font-medium text-gray-600"},ae={class:"border-t border-gray-200 pt-4"},ne={class:"divide-y divide-gray-200"},le={class:"py-3 flex justify-between"},oe={class:"text-sm text-gray-600"},ie={class:"py-3 flex justify-between"},de={class:"text-sm text-gray-600"},ue={class:"py-3 flex justify-between"},me={class:"text-sm text-gray-600"},ce={class:"py-3 flex justify-between"},ve={class:"text-sm text-gray-600"},xe={class:"bg-white rounded-lg shadow-sm overflow-hidden"},fe={class:"p-6"},ge={class:"divide-y divide-gray-200"},pe={class:"py-3 flex items-center"},ye={class:"text-sm text-gray-800 flex-1"},he={class:"py-3 flex items-center"},we={class:"text-sm text-gray-800 flex-1"},be=["href"],_e={class:"py-3 flex items-center"},ke={class:"text-sm text-gray-600 flex-1"},Ce=["href"],je={key:1,class:"text-gray-500 italic"},Me={class:"bg-white rounded-lg shadow-sm overflow-hidden"},$e={class:"p-6 space-y-6"},Ae={key:0,class:"bg-gray-50 rounded-md p-2"},Le={class:"text-sm text-gray-600"},Be={class:"overflow-hidden"},Ve={class:"divide-y divide-gray-200"},ze={class:"flex items-center justify-between"},De={class:"text-xs font-medium text-gray-600"},Ie={key:1,class:"text-sm text-gray-500 italic"},Fe={key:0,class:"bg-gray-50 rounded-md p-2"},Se={class:"text-sm text-gray-600"},Ee={class:"overflow-hidden"},Ne={class:"divide-y divide-gray-200"},Re={class:"flex items-center justify-between"},He={class:"text-xs font-medium text-gray-600"},Te={key:1,class:"text-sm text-gray-500 italic"},Pe={key:3,class:"fixed inset-0 z-50 overflow-y-auto","aria-labelledby":"modal-title",role:"dialog","aria-modal":"true"},qe={class:"flex items-end justify-center min-h-screen pt-4 px-4 pb-20 text-center sm:block sm:p-0"},Ue={class:"inline-block align-bottom bg-white rounded-lg text-left overflow-hidden shadow-xl transform transition-all sm:my-8 sm:align-middle sm:max-w-lg sm:w-full"},Ke={class:"bg-gray-50 px-4 py-3 sm:px-6 sm:flex sm:flex-row-reverse"},Xe=["disabled"],Ge={key:0,class:"animate-spin -ml-1 mr-2 h-4 w-4 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},Je={__name:"ClientDetailView",setup(Oe){const p=R(),A=q(),y=N(()=>p.params.id),r=u(null),h=u(!0),m=u(null),d=u(!1),c=u(!1);H(()=>{v()}),C(()=>p.params.id,(s,t)=>{s!==t&&v()}),C(()=>p.query,s=>{s.refresh&&v()},{deep:!0});const v=async()=>{h.value=!0,m.value=null;try{const s=await j.getClient(y.value);if(s.data&&s.data.status==="success")r.value=s.data.data,console.log("Client chargé:",r.value);else throw new Error("Impossible de récupérer les informations du client")}catch(s){console.error("Erreur lors du chargement du client:",s),m.value="Une erreur est survenue lors du chargement des informations du client. Veuillez réessayer."}finally{h.value=!1}},L=(s,t)=>(s?s.charAt(0):"")+(t?t.charAt(0):""),B=s=>{const t="px-2 py-1 text-sm leading-5 font-semibold rounded-full";switch(s){case"active":return`${t} bg-green-100 text-green-800`;case"inactive":return`${t} bg-gray-100 text-gray-800`;case"blacklisted":return`${t} bg-red-100 text-red-800`;default:return`${t} bg-gray-100 text-gray-800`}},V=s=>{switch(s){case"active":return"Actif";case"inactive":return"Inactif";case"blacklisted":return"Liste noire";default:return s}},z=s=>{if(!s)return"";const t=new Date(s);return new Intl.DateTimeFormat("fr-FR",{day:"numeric",month:"long",year:"numeric"}).format(t)},_=s=>new Intl.NumberFormat("fr-FR",{style:"currency",currency:"XAF",minimumFractionDigits:0}).format(s||0),D=()=>{d.value=!0},I=async()=>{c.value=!0;try{const s=await j.deleteClient(y.value);s.data&&s.data.status==="success"&&A.push("/clients")}catch(s){console.error("Erreur lors de la suppression du client:",s),s.response&&s.response.data&&s.response.data.message?alert(s.response.data.message):alert("Une erreur est survenue lors de la suppression du client."),d.value=!1}finally{c.value=!1}},F=s=>{switch(s){case"active":return"Actif";case"inactive":return"Inactif";case"closed":return"Fermé";default:return s}},S=s=>{switch(s){case"active":return"Actif";case"pending":return"En attente";case"completed":return"Terminé";case"defaulted":return"En défaut";default:return s}};return(s,t)=>{var k;const x=T("router-link");return o(),l("div",null,[e("div",U,[e("div",K,[e("button",{onClick:t[0]||(t[0]=a=>s.$router.push("/clients")),class:"mr-4 p-2 rounded-full hover:bg-gray-100"},t[5]||(t[5]=[e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-3 w-5 text-gray-600",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M10 19l-7-7m0 0l7-7m-7 7h18"})],-1)])),t[6]||(t[6]=e("h1",{class:"text-sm font-medium text-gray-800"},"Détails du client",-1))]),e("div",X,[f(x,{to:`/clients/${y.value}/edit`,class:"btn btn-secondary flex items-center"},{default:g(()=>t[7]||(t[7]=[e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-4 w-4 mr-2",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15.232 5.232l3.536 3.536m-2.036-5.036a2.5 2.5 0 113.536 3.536L6.5 21.036H3v-3.572L16.732 3.732z"})],-1),e("span",{class:"text-sm"},"Modifier",-1)])),_:1},8,["to"]),e("button",{onClick:t[1]||(t[1]=a=>D()),class:"btn text-sm btn-danger flex items-center"},t[8]||(t[8]=[e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-4 w-4 mr-2",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})],-1),e("span",{class:"text-sm"},"Supprimer",-1)]))])]),h.value?(o(),l("div",G,t[9]||(t[9]=[e("div",{class:"inline-block animate-spin rounded-full h-8 w-8 border-t-2 border-b-2 border-primary"},null,-1),e("p",{class:"mt-2 text-gray-500"},"Chargement des informations du client...",-1)]))):m.value?(o(),l("div",J,[t[10]||(t[10]=e("div",{class:"flex items-center text-red-500 mb-4"},[e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-6 w-6 mr-2",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})]),e("h2",{class:"text-sm font-medium"},"Erreur")],-1)),e("p",O,n(m.value),1),e("button",{onClick:t[2]||(t[2]=a=>v()),class:"mt-4 btn btn-primary"},"Réessayer")])):r.value?(o(),l("div",Q,[e("div",W,[e("div",Y,[e("div",Z,[e("div",ee,[e("span",te,n(L(r.value.first_name,r.value.last_name)),1)]),e("div",se,[e("h2",re,n(r.value.first_name)+" "+n(r.value.last_name),1),e("span",{class:b(B(r.value.status))},n(V(r.value.status)),3)])]),e("div",ae,[e("dl",ne,[e("div",le,[t[11]||(t[11]=e("dt",{class:"text-sm font-medium text-gray-500"},"ID Carte",-1)),e("dd",oe,n(r.value.id_card_number),1)]),e("div",ie,[t[12]||(t[12]=e("dt",{class:"text-sm font-medium text-gray-500"},"Profession",-1)),e("dd",de,n(r.value.profession),1)]),e("div",ue,[t[13]||(t[13]=e("dt",{class:"text-sm font-medium text-gray-500"},"Agent assigné",-1)),e("dd",me,n(((k=r.value.agent)==null?void 0:k.name)||"Non assigné"),1)]),e("div",ce,[t[14]||(t[14]=e("dt",{class:"text-sm font-medium text-gray-500"},"Créé le",-1)),e("dd",ve,n(z(r.value.created_at)),1)])])])])]),e("div",xe,[t[18]||(t[18]=e("div",{class:"px-6 py-4 border-b border-gray-200"},[e("h3",{class:"text-sm font-medium text-gray-500"},"Informations de contact")],-1)),e("div",fe,[e("dl",ge,[e("div",pe,[t[15]||(t[15]=e("dt",{class:"text-sm font-medium text-gray-500 w-24"},"Adresse",-1)),e("dd",ye,n(r.value.address),1)]),e("div",he,[t[16]||(t[16]=e("dt",{class:"text-sm font-medium text-gray-500 w-24"},"Téléphone",-1)),e("dd",we,[e("a",{href:`tel:${r.value.phone_number}`,class:"text-primary hover:text-primary-dark"},n(r.value.phone_number),9,be)])]),e("div",_e,[t[17]||(t[17]=e("dt",{class:"text-sm font-medium text-gray-500 w-24"},"Email",-1)),e("dd",ke,[r.value.email?(o(),l("a",{key:0,href:`mailto:${r.value.email}`,class:"text-primary hover:text-primary-dark"},n(r.value.email),9,Ce)):(o(),l("span",je,"Non renseigné"))])])])])]),e("div",Me,[t[23]||(t[23]=e("div",{class:"px-6 py-4 border-b border-gray-200"},[e("h3",{class:"text-sm font-medium text-gray-500"},"Résumé financier")],-1)),e("div",$e,[e("div",null,[t[21]||(t[21]=e("h4",{class:"font-noromal text-sm text-gray-600 opacity-1 mb-2 flex items-center"},[e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-3 w-5 mr-2 text-primary",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})]),i(" Prêts ")],-1)),r.value.loans&&r.value.loans.length>0?(o(),l("div",Ae,[e("div",Le,[e("div",null,[e("div",Be,[e("ul",Ve,[(o(!0),l(M,null,$(r.value.loans,a=>(o(),l("li",{key:a.id,class:"py-1"},[e("div",ze,[e("div",null,[f(x,{to:`/loans/${a.id}`,class:"text-xs font-medium text-primary hover:text-primary-dark"},{default:g(()=>[i(" Prêt #"+n(a.id),1)]),_:2},1032,["to"]),e("span",{class:b(["ml-2 px-2 inline-flex text-xs leading-5 font-medium rounded-lg",{"bg-green-100 text-green-800":a.status==="active","bg-yellow-100 text-yellow-800":a.status==="pending","bg-blue-100 text-blue-800":a.status==="completed","bg-red-100 text-red-800":a.status==="defaulted"}])},n(S(a.status)),3)]),e("div",De,n(_(a.amount)),1)])]))),128))])])])])])):(o(),l("div",Ie,[t[20]||(t[20]=i(" Aucun prêt ")),f(x,{to:`/loans/new?client_id=${r.value.id}`,class:"text-primary hover:text-primary-dark ml-2"},{default:g(()=>t[19]||(t[19]=[i(" Créer un prêt ")])),_:1},8,["to"])]))]),e("div",null,[t[22]||(t[22]=e("h4",{class:"font-normal text-sm text-gray-600 opacity-1 mb-2 flex items-center"},[e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-3 w-5 mr-2 text-primary",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M17 9V7a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2m2 4h10a2 2 0 002-2v-6a2 2 0 00-2-2H9a2 2 0 00-2 2v6a2 2 0 002 2zm7-5a2 2 0 11-4 0 2 2 0 014 0z"})]),i(" Comptes d'épargne ")],-1)),r.value.savings_accounts&&r.value.savings_accounts.length>0?(o(),l("div",Fe,[e("div",Se,[e("div",Ee,[e("ul",Ne,[(o(!0),l(M,null,$(r.value.savings_accounts,a=>(o(),l("li",{key:a.id,class:"py-1"},[e("div",Re,[e("div",null,[f(x,{to:`/savings/${a.id}`,class:"text-xs font-medium text-primary hover:text-primary-dark"},{default:g(()=>[i(n(a.account_number),1)]),_:2},1032,["to"]),e("span",{class:b(["ml-2 px-2 inline-flex text-xs leading-5 font-medium rounded-lg",{"bg-green-100 text-green-800":a.status==="active","bg-yellow-100 text-yellow-800":a.status==="inactive","bg-red-100 text-red-800":a.status==="closed"}])},n(F(a.status)),3)]),e("div",He,n(_(a.balance)),1)])]))),128))])])])])):(o(),l("div",Te,"Aucun compte d'épargne"))])])])])):w("",!0),d.value?(o(),l("div",Pe,[e("div",qe,[e("div",{class:"fixed inset-0 bg-gray-500 bg-opacity-75 transition-opacity","aria-hidden":"true",onClick:t[3]||(t[3]=a=>d.value=!1)}),t[27]||(t[27]=e("span",{class:"hidden sm:inline-block sm:align-middle sm:h-screen","aria-hidden":"true"},"​",-1)),e("div",Ue,[t[26]||(t[26]=P('<div class="bg-white px-4 pt-5 pb-4 sm:p-6 sm:pb-4" data-v-1a6788cf><div class="sm:flex sm:items-start" data-v-1a6788cf><div class="mx-auto flex-shrink-0 flex items-center justify-center h-12 w-12 rounded-full bg-red-100 sm:mx-0 sm:h-10 sm:w-10" data-v-1a6788cf><svg class="h-4 w-4 text-red-600" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" data-v-1a6788cf><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z" data-v-1a6788cf></path></svg></div><div class="mt-3 text-center sm:mt-0 sm:ml-4 sm:text-left" data-v-1a6788cf><h3 class="text-sm leading-6 font-normal text-gray-800" id="modal-title" data-v-1a6788cf> Supprimer le client </h3><div class="mt-2" data-v-1a6788cf><p class="text-sm text-gray-500" data-v-1a6788cf> Êtes-vous sûr de vouloir supprimer ce client ? Cette action est irréversible. </p></div></div></div></div>',1)),e("div",Ke,[e("button",{type:"button",class:"w-full inline-flex justify-center rounded-md border border-transparent shadow-sm px-4 py-2 bg-red-400 text-base font-medium text-white hover:bg-red-600 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-red-500 sm:ml-3 sm:w-auto sm:text-sm",onClick:I,disabled:c.value},[c.value?(o(),l("svg",Ge,t[24]||(t[24]=[e("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"},null,-1),e("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"},null,-1)]))):w("",!0),t[25]||(t[25]=i(" Supprimer "))],8,Xe),e("button",{type:"button",class:"mt-3 w-full inline-flex justify-center rounded-md border border-gray-300 shadow-sm px-4 py-2 bg-white text-base font-medium text-gray-600 hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary sm:mt-0 sm:ml-3 sm:w-auto sm:text-sm",onClick:t[4]||(t[4]=a=>d.value=!1)}," Annuler ")])])])])):w("",!0)])}}},We=E(Je,[["__scopeId","data-v-1a6788cf"]]);export{We as default};
