import{_ as Y,N as Z,r as u,B as _,o as tt,a as et,c as l,b as t,d as j,w as N,g as st,y as $,z as at,D as ot,k as rt,F as q,l as H,t as r,q as f,M as nt,m as i,n as lt}from"./index-CHW42hPp.js";const it={class:"flex justify-between items-center mb-4"},dt={class:"flex items-center"},ut={class:"flex space-x-2"},ct={class:"relative w-64"},pt={key:0,class:"flex justify-center py-6"},xt={key:1,class:"text-center py-8"},vt={key:2,class:"mt-2"},mt={class:"bg-white overflow-x-auto rounded-md shadow-sm border border-gray-200"},gt={class:"min-w-full divide-y divide-gray-200"},ft={class:"bg-white divide-y divide-gray-200"},yt=["onClick"],ht={class:"px-6 py-4 text-xs whitespace-nowrap"},wt={class:"flex items-center"},bt={class:"h-8 w-8 rounded-full bg-secondary text-white flex items-center justify-center text-sm font-medium"},_t={class:"ml-3"},kt={class:"text-xs font-medium text-gray-500"},Ct={class:"text-xs text-gray-500"},Mt={class:"px-6 py-4 whitespace-nowrap"},Pt={class:"text-xs text-gray-500 font-medium"},Vt={class:"text-xs text-gray-500"},Tt={class:"px-6 py-4 whitespace-nowrap"},Bt={class:"text-xs font-medium text-gray-500"},zt={class:"text-xs text-gray-500"},Dt={class:"px-6 py-4 whitespace-nowrap text-xs font-medium text-gray-500"},Et={class:"px-6 py-4 whitespace-nowrap"},Ft={class:"mt-4 flex justify-between items-center"},Rt={class:"text-xs text-gray-700"},St={class:"flex space-x-1"},At=["disabled"],Lt=["onClick"],jt={key:1,class:"px-2 py-1 text-xs"},Nt=["disabled"],$t={__name:"RepaymentListView",setup(qt){const I=nt(),k=Z(),y=u(!0),h=u([]),p=u(""),w=u(null),x=u(""),o=u(1),v=u(10),m=u(0),d=_(()=>Math.ceil(m.value/v.value)),U=_(()=>[...h.value].sort((s,e)=>{const n={late:0,pending:1,missed:2,paid:3};return n[s.status]-n[e.status]})),G=_(()=>{const s=[];if(d.value<=5)for(let n=1;n<=d.value;n++)s.push(n);else{s.push(1);let n=Math.max(2,o.value-1),a=Math.min(d.value-1,o.value+1);n>2&&s.push("...");for(let c=n;c<=a;c++)s.push(c);a<d.value-1&&s.push("..."),s.push(d.value)}return s});tt(()=>{g()});async function g(){y.value=!0;try{const s={page:o.value,per_page:v.value};p.value&&(s.search=p.value),x.value&&(s.status=x.value);const e=await et.getAllRepayments(s);e.data.status==="success"?(h.value=e.data.data.data,m.value=e.data.data.total,o.value=e.data.data.current_page):k.showToast("Erreur lors de la récupération des remboursements","error")}catch(s){console.error("Erreur lors de la récupération des remboursements:",s),k.showToast("Erreur lors de la récupération des remboursements","error")}finally{y.value=!1}}function O(){w.value&&clearTimeout(w.value),w.value=setTimeout(()=>{o.value=1,g()},300)}function Q(){o.value=1,g()}function b(s){s<1||s>d.value||(o.value=s,g())}function C(s){return new Intl.NumberFormat("fr-FR",{style:"currency",currency:"XAF",maximumFractionDigits:0}).format(s)}function X(s){const e=new Date(s);return new Intl.DateTimeFormat("fr-FR",{day:"2-digit",month:"2-digit",year:"numeric"}).format(e)}function J(s){switch(s){case"pending":return"En attente";case"paid":return"Payé";case"late":return"En retard";case"missed":return"Manqué";default:return s}}function K(s){switch(s){case"pending":return"bg-yellow-100 text-yellow-800";case"paid":return"bg-green-100 text-green-800";case"late":return"bg-red-100 text-red-800";case"missed":return"bg-gray-100 text-gray-800";default:return"bg-gray-100 text-gray-800"}}function W(s){s&&I.push(`/loans/${s}`)}return(s,e)=>{const n=st("router-link");return i(),l("div",null,[t("div",it,[t("div",dt,[j(n,{to:"/loans",class:"text-primary hover:text-primary-dark flex items-center mr-3"},{default:N(()=>e[4]||(e[4]=[t("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-4 w-4 mr-1",viewBox:"0 0 20 20",fill:"currentColor"},[t("path",{"fill-rule":"evenodd",d:"M9.707 16.707a1 1 0 01-1.414 0l-6-6a1 1 0 010-1.414l6-6a1 1 0 011.414 1.414L5.414 9H17a1 1 0 110 2H5.414l4.293 4.293a1 1 0 010 1.414z","clip-rule":"evenodd"})],-1)])),_:1}),e[5]||(e[5]=t("h1",{class:"text-sm font-medium tracking-widest text-gray-600"},"Gestion des remboursements",-1))]),t("div",ut,[t("div",ct,[$(t("input",{"onUpdate:modelValue":e[0]||(e[0]=a=>p.value=a),onInput:O,type:"text",placeholder:"Rechercher un client...",class:"w-full px-3 py-1.5 text-xs border border-gray-300 rounded-md focus:outline-none focus:ring-1 focus:ring-primary"},null,544),[[at,p.value]]),e[6]||(e[6]=t("span",{class:"absolute right-2 top-1.5 text-gray-400"},[t("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})])],-1))]),$(t("select",{"onUpdate:modelValue":e[1]||(e[1]=a=>x.value=a),onChange:Q,class:"px-3 py-1.5 text-xs border border-gray-300 rounded-md focus:outline-none focus:ring-1 focus:ring-primary"},e[7]||(e[7]=[rt('<option value="" data-v-76abbebf>Tous les statuts</option><option value="pending" data-v-76abbebf>En attente</option><option value="paid" data-v-76abbebf>Payé</option><option value="late" data-v-76abbebf>En retard</option><option value="missed" data-v-76abbebf>Manqué</option>',5)]),544),[[ot,x.value]]),j(n,{to:"/loans/overdue",class:"btn btn-secondary flex items-center text-xs px-3 py-1.5 rounded-md bg-gray-200 hover:bg-gray-300 text-gray-700"},{default:N(()=>e[8]||(e[8]=[t("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-4 w-4 mr-1",viewBox:"0 0 20 20",fill:"currentColor"},[t("path",{"fill-rule":"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm1-12a1 1 0 10-2 0v4a1 1 0 00.293.707l2.828 2.829a1 1 0 101.415-1.415L11 9.586V6z","clip-rule":"evenodd"})],-1),lt(" En retard uniquement ")])),_:1})])]),y.value?(i(),l("div",pt,e[9]||(e[9]=[t("svg",{class:"animate-spin h-5 w-5 text-primary",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},[t("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"}),t("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})],-1)]))):h.value.length===0?(i(),l("div",xt,e[10]||(e[10]=[t("div",{class:"text-gray-400 mb-2"},[t("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-12 w-12 mx-auto",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"1",d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})])],-1),t("p",{class:"text-sm text-gray-600"},"Aucun remboursement trouvé",-1)]))):(i(),l("div",vt,[t("div",mt,[t("table",gt,[e[11]||(e[11]=t("thead",{class:"bg-gray-50"},[t("tr",null,[t("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Client"),t("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Prêt"),t("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Date d'échéance"),t("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Montant"),t("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Statut")])],-1)),t("tbody",ft,[(i(!0),l(q,null,H(U.value,a=>{var c,M,P,V,T,B,z,D,E,F,R,S,A,L;return i(),l("tr",{key:a.id,onClick:Ht=>W(a.loan_id),class:"repayment-row"},[t("td",ht,[t("div",wt,[t("div",bt,r(((P=(M=(c=a.loan)==null?void 0:c.client)==null?void 0:M.first_name)==null?void 0:P.charAt(0).toUpperCase())||"")+r(((B=(T=(V=a.loan)==null?void 0:V.client)==null?void 0:T.last_name)==null?void 0:B.charAt(0).toUpperCase())||""),1),t("div",_t,[t("div",kt,r(((D=(z=a.loan)==null?void 0:z.client)==null?void 0:D.first_name)||"")+" "+r(((F=(E=a.loan)==null?void 0:E.client)==null?void 0:F.last_name)||""),1),t("div",Ct,r(((S=(R=a.loan)==null?void 0:R.client)==null?void 0:S.phone_number)||""),1)])])]),t("td",Mt,[t("div",Pt," Prêt #"+r(((A=a.loan)==null?void 0:A.id)||""),1),t("div",Vt,r(C(((L=a.loan)==null?void 0:L.amount)||0)),1)]),t("td",Tt,[t("div",Bt,r(X(a.due_date)),1),t("div",zt,"Échéance #"+r(a.id),1)]),t("td",Dt,r(C(a.amount)),1),t("td",Et,[t("span",{class:f([K(a.status),"px-2 inline-flex text-xs leading-5 font-medium rounded-lg"])},r(J(a.status)),3)])],8,yt)}),128))])])]),t("div",Ft,[t("div",Rt," Affichage de "+r((o.value-1)*v.value+1)+" à "+r(Math.min(o.value*v.value,m.value))+" sur "+r(m.value)+" résultats ",1),t("div",St,[t("button",{onClick:e[2]||(e[2]=a=>b(o.value-1)),disabled:o.value===1,class:f([o.value===1?"opacity-50 cursor-not-allowed":"","px-3 py-1 text-xs border border-gray-300 rounded-md hover:bg-gray-100"])}," Précédent ",10,At),(i(!0),l(q,null,H(G.value,a=>(i(),l("div",{key:a},[a!=="..."?(i(),l("button",{key:0,onClick:c=>b(a),class:f([o.value===a?"bg-primary text-white":"bg-white text-gray-700 hover:bg-gray-100","px-3 py-1 text-xs border border-gray-300 rounded-md"])},r(a),11,Lt)):(i(),l("span",jt,r(a),1))]))),128)),t("button",{onClick:e[3]||(e[3]=a=>b(o.value+1)),disabled:o.value===d.value,class:f([o.value===d.value?"opacity-50 cursor-not-allowed":"","px-3 py-1 text-xs border border-gray-300 rounded-md hover:bg-gray-100"])}," Suivant ",10,Nt)])])]))])}}},Ut=Y($t,[["__scopeId","data-v-76abbebf"]]);export{Ut as default};
