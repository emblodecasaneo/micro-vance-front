import{_ as ot,c as o,b as t,x as y,d as lt,w as it,g as dt,t as r,n as R,k as ct,q as P,p as mt,F as N,l as q,y as E,D as ut,z as B,N as xt,r as c,L as yt,B as f,o as gt,O as pt,a as C,M as ft,m as l,v as j}from"./index-CHW42hPp.js";const vt={name:"LoanDetailView",setup(){const v=yt(),s=ft(),{showToast:u}=xt(),e=c({}),L=c({total_amount:0,paid_amount:0,remaining_amount:0,progress:0,paid_repayments:0,total_repayments:0,remaining_repayments:0,days_remaining:0}),A=c(!1),m=c(!0),n=c(!1),d=c({}),b=c({payment_method:"cash",transaction_reference:"",penalty_amount:0}),z=c(!1),T=c(!1),F=c(!1),M=c(null),_=v.params.id,I=f(()=>!d.value||!e.value.repayments?-1:e.value.repayments.findIndex(a=>a.id===d.value.id)),H=f(()=>{if(!d.value.due_date)return!1;const a=new Date(d.value.due_date);return new Date>a}),U=()=>d.value.amount?Math.round(d.value.amount*.05*100)/100:0,X=f(()=>e.value.client?`${e.value.client.last_name} ${e.value.client.first_name}`:"N/A"),k=async()=>{m.value=!0;try{const a=await C.getLoan(_);e.value=a.data.data.loan,L.value=a.data.data.stats,A.value=a.data.data.is_late,w.value=1}catch(a){console.error("Erreur lors du chargement du prêt:",a),u("Erreur lors du chargement du prêt.","error"),s.push("/loans")}finally{m.value=!1}},O=async()=>{try{m.value=!0,await C.approveLoan(_),u("Prêt approuvé avec succès.","success"),k()}catch(a){console.error("Erreur lors de l'approbation du prêt:",a),u("Erreur lors de l'approbation du prêt.","error")}finally{m.value=!1}},G=async()=>{if(confirm("Êtes-vous sûr de vouloir supprimer ce prêt ?"))try{m.value=!0,await C.deleteLoan(_),u("Prêt supprimé avec succès.","success"),s.push("/loans")}catch(a){console.error("Erreur lors de la suppression du prêt:",a),u("Erreur lors de la suppression du prêt.","error")}finally{m.value=!1}},S=a=>{const i=new Date,x=new Date(a.due_date);return i>x},J=a=>{d.value=a,b.value={payment_method:"cash",transaction_reference:"",penalty_amount:S(a)?Math.round(a.amount*.05*100)/100:0},n.value=!0},K=async()=>{z.value=!0;try{await C.recordRepayment(_,d.value.id,b.value),u("Paiement enregistré avec succès.","success"),n.value=!1,k()}catch(a){console.error("Erreur lors de l'enregistrement du paiement:",a),u("Erreur lors de l'enregistrement du paiement.","error")}finally{z.value=!1}},Q=async a=>{if(confirm("Êtes-vous sûr de vouloir marquer ce remboursement comme manqué ?"))try{m.value=!0,await C.missingRepayment(_,a.id),u("Remboursement marqué comme manqué.","success"),k()}catch(i){console.error("Erreur lors du marquage du remboursement:",i),u("Erreur lors du marquage du remboursement.","error")}finally{m.value=!1}},W=a=>a?new Intl.NumberFormat("fr-FR",{style:"currency",currency:"XAF"}).format(a):"0 XAF",Y=a=>{if(!a)return"N/A";const i=new Date(a);return new Intl.DateTimeFormat("fr-FR").format(i)},Z=a=>({pending:"bg-yellow-100 text-yellow-800",active:"bg-green-100 text-green-800",completed:"bg-blue-100 text-blue-800",defaulted:"bg-red-100 text-red-800"})[a]||"bg-gray-100 text-gray-800",$=a=>({pending:"En attente",active:"Actif",completed:"Complété",defaulted:"Défaillant"})[a]||a,tt=a=>({pending:"bg-yellow-100 text-yellow-800",paid:"bg-green-100 text-green-800",late:"bg-orange-100 text-orange-800",missed:"bg-red-100 text-red-800"})[a]||"bg-gray-100 text-gray-800",et=a=>({pending:"En attente",paid:"Payé",late:"En retard",missed:"Manqué"})[a]||a,st=a=>{M.value=M.value===a?null:a},V=a=>{const i=document.querySelectorAll('[role="menu"]'),x=document.querySelectorAll('button[class^="text-gray-500"]');let h=!0;i.forEach(p=>{p.contains(a.target)&&(h=!1)}),x.forEach(p=>{p.contains(a.target)&&(h=!1)}),h&&(M.value=null)},D=5,w=c(1),g=f(()=>e.value.repayments?Math.ceil(e.value.repayments.length/D):1),at=f(()=>{const a=[];if(g.value<=5)for(let x=1;x<=g.value;x++)a.push(x);else{a.push(1);let x=Math.max(2,w.value-1),h=Math.min(g.value-1,w.value+1);x>2&&a.push("...");for(let p=x;p<=h;p++)a.push(p);h<g.value-1&&a.push("..."),g.value>1&&a.push(g.value)}return a}),nt=f(()=>{if(!e.value.repayments)return[];const a=(w.value-1)*D,i=a+D;return e.value.repayments.slice(a,i)}),rt=a=>{w.value=a};return gt(()=>{k(),document.addEventListener("click",V)}),pt(()=>{document.removeEventListener("click",V)}),{loan:e,stats:L,isLate:A,loading:m,showPaymentModal:n,selectedRepayment:d,paymentData:b,paymentProcessing:z,isSelectedRepaymentLate:f(()=>{if(!d.value.due_date)return!1;const a=new Date,i=new Date(d.value.due_date);return a>i}),clientName:X,loadLoan:k,approveLoan:O,deleteLoan:G,isRepaymentLate:S,openPaymentModal:J,recordPayment:K,markAsMissed:Q,formatCurrency:W,formatDate:Y,getStatusClass:Z,getStatusLabel:$,getRepaymentStatusClass:tt,getRepaymentStatusLabel:et,selectedRepaymentIndex:I,isLatePayment:H,calculatePenalty:U,toggleActionMenu:st,showDeleteModal:T,deleting:F,activeActionMenu:M,repaymentsPerPage:D,currentRepaymentPage:w,totalRepaymentPages:g,displayedRepaymentPages:at,paginatedRepayments:nt,goToRepaymentPage:rt}}},bt={class:"flex justify-between items-center mb-4"},wt={class:"flex items-center"},ht={class:"text-sm tracking-widest font-medium text-gray-800"},_t={class:"flex space-x-2"},kt={key:0,class:"flex justify-center py-6"},Pt={key:1},Ct={key:0,class:"bg-red-100 border-l-4 border-red-500 text-red-700 p-3 mb-4 text-xs"},Mt={class:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-4"},Dt={class:"bg-white shadow-sm rounded-lg p-4 border border-gray-200"},Rt={class:"grid grid-cols-2 gap-3"},Lt={class:"text-xs font-medium text-gray-700"},At={class:"text-xs font-medium text-gray-700"},zt={class:"text-xs font-medium text-gray-700"},Et={class:"text-xs font-medium text-gray-700"},St={class:"text-xs font-medium text-gray-700"},Vt={class:"text-xs font-medium text-gray-700"},Nt={class:"text-xs font-medium text-gray-700"},qt={class:"text-xs font-medium text-gray-700"},Bt={class:"text-xs font-medium text-gray-700"},jt={class:"text-xs font-medium text-gray-700"},Tt={class:"text-xs font-medium text-gray-700"},Ft={class:"bg-white shadow-sm rounded-lg p-4 border border-gray-200"},It={class:"mb-3"},Ht={class:"w-full h-3 bg-gray-200 rounded-full"},Ut={class:"text-right text-xs mt-1"},Xt={class:"grid grid-cols-2 gap-3"},Ot={class:"text-xs font-medium text-gray-700"},Gt={class:"text-xs font-medium text-gray-700"},Jt={class:"text-xs font-medium text-gray-700"},Kt={class:"text-xs font-medium text-gray-700"},Qt={class:"text-xs font-medium text-gray-700"},Wt={key:0},Yt={class:"text-xs font-medium text-gray-700"},Zt={class:"bg-white shadow-sm rounded-lg p-4 border border-gray-200"},$t={key:0,class:"overflow-x-auto"},te={class:"min-w-full divide-y divide-gray-200"},ee={class:"bg-white divide-y divide-gray-200"},se={class:"py-3 px-4 whitespace-nowrap"},ae={class:"text-xs font-medium text-gray-600"},ne={class:"py-3 px-4 whitespace-nowrap"},re={class:"text-xs font-medium text-gray-600"},oe={class:"py-3 px-4 whitespace-nowrap"},le={class:"text-xs font-medium text-gray-600"},ie={class:"py-3 px-4 whitespace-nowrap"},de={class:"text-xs font-medium text-gray-600"},ce={class:"py-3 px-4 whitespace-nowrap"},me={class:"text-xs font-medium text-gray-600"},ue={class:"py-3 px-4 whitespace-nowrap"},xe={class:"py-3 px-4 whitespace-nowrap text-center"},ye={key:0,class:"relative"},ge=["onClick"],pe={key:0,class:"absolute right-0 z-10 mt-2 w-48 rounded-md shadow-lg bg-white ring-1 ring-black ring-opacity-5 focus:outline-none py-1",role:"menu"},fe=["onClick"],ve=["onClick"],be={key:1,class:"text-gray-400"},we={class:"mt-4 flex justify-between items-center"},he={class:"text-xs text-gray-700"},_e={class:"flex space-x-1"},ke=["disabled"],Pe=["onClick"],Ce={key:1,class:"px-2 py-1 text-xs"},Me=["disabled"],De={key:1,class:"text-center py-3 text-xs text-gray-500"},Re={key:2,class:"fixed inset-0 overflow-y-auto z-50 flex items-center justify-center"},Le={class:"relative bg-white rounded-lg shadow-lg p-4 max-w-md w-full mx-4"},Ae={class:"mb-3"},ze={class:"flex justify-between mb-2"},Ee={class:"text-xs font-medium"},Se={class:"flex justify-between mb-2"},Ve={class:"text-xs font-medium"},Ne={class:"flex justify-between mb-2"},qe={class:"text-xs font-medium"},Be={key:0,class:"flex justify-between mb-2"},je={class:"text-xs font-medium text-red-600"},Te={key:1,class:"flex justify-between mb-2"},Fe={class:"text-xs font-medium"},Ie={class:"mb-3"},He={class:"mb-3"},Ue={key:0,class:"mb-3"},Xe={class:"flex justify-end space-x-2 mt-4"},Oe=["disabled"],Ge={key:0},Je={key:1,class:"text-xs"},Ke={key:3,class:"fixed inset-0 overflow-y-auto z-50 flex items-center justify-center"},Qe={class:"relative bg-white rounded-lg shadow-lg p-4 max-w-md w-full mx-4"},We={class:"flex justify-end space-x-2"},Ye=["disabled"],Ze={key:0},$e={key:1};function ts(v,s,u,e,L,A){const m=dt("router-link");return l(),o("div",null,[t("div",bt,[t("div",wt,[lt(m,{to:"/loans",class:"text-primary hover:text-primary-dark flex items-center mr-3"},{default:it(()=>s[13]||(s[13]=[t("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-4 w-4 mr-1",viewBox:"0 0 20 20",fill:"currentColor"},[t("path",{"fill-rule":"evenodd",d:"M9.707 16.707a1 1 0 01-1.414 0l-6-6a1 1 0 010-1.414l6-6a1 1 0 011.414 1.414L5.414 9H17a1 1 0 110 2H5.414l4.293 4.293a1 1 0 010 1.414z","clip-rule":"evenodd"})],-1)])),_:1}),t("h1",ht,"Détails du prêt #"+r(e.loan.id),1)]),t("div",_t,[e.loan.status==="pending"?(l(),o("button",{key:0,onClick:s[0]||(s[0]=(...n)=>e.approveLoan&&e.approveLoan(...n)),class:"btn btn-primary flex items-center"},s[14]||(s[14]=[t("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-4 w-4 mr-1",viewBox:"0 0 20 20",fill:"currentColor"},[t("path",{"fill-rule":"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z","clip-rule":"evenodd"})],-1),R(" Approuver ")]))):y("",!0),e.loan.status==="pending"?(l(),o("button",{key:1,onClick:s[1]||(s[1]=(...n)=>e.deleteLoan&&e.deleteLoan(...n)),class:"btn btn-danger flex items-center"},s[15]||(s[15]=[t("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-4 w-4 mr-1",viewBox:"0 0 20 20",fill:"currentColor"},[t("path",{"fill-rule":"evenodd",d:"M9 2a1 1 0 00-.894.553L7.382 4H4a1 1 0 000 2v10a2 2 0 002 2h8a2 2 0 002-2V6a1 1 0 100-2h-3.382l-.724-1.447A1 1 0 0011 2H9zM7 8a1 1 0 012 0v6a1 1 0 11-2 0V8zm5-1a1 1 0 00-1 1v6a1 1 0 102 0V8a1 1 0 00-1-1z","clip-rule":"evenodd"})],-1),R(" Supprimer ")]))):y("",!0)])]),e.loading?(l(),o("div",kt,s[16]||(s[16]=[t("svg",{class:"animate-spin h-5 w-5 text-primary",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},[t("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"}),t("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})],-1)]))):(l(),o("div",Pt,[e.loan.status==="active"&&e.isLate?(l(),o("div",Ct,s[17]||(s[17]=[ct('<div class="flex" data-v-14b8cf57><div class="flex-shrink-0" data-v-14b8cf57><svg class="h-4 w-4 text-red-500" viewBox="0 0 20 20" fill="currentColor" data-v-14b8cf57><path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7 4a1 1 0 11-2 0 1 1 0 012 0zm-1-9a1 1 0 00-1 1v4a1 1 0 102 0V6a1 1 0 00-1-1z" clip-rule="evenodd" data-v-14b8cf57></path></svg></div><div class="ml-3" data-v-14b8cf57><p data-v-14b8cf57>Ce prêt est actuellement en retard de paiement.</p></div></div>',1)]))):y("",!0),t("div",Mt,[t("div",Dt,[s[30]||(s[30]=t("h2",{class:"text-xs font-medium text-gray-700 mb-3"},"Informations générales",-1)),t("div",Rt,[t("div",null,[s[18]||(s[18]=t("p",{class:"text-xs text-gray-500"},"ID du prêt",-1)),t("p",Lt,r(e.loan.id),1)]),t("div",null,[s[19]||(s[19]=t("p",{class:"text-xs text-gray-500"},"Statut",-1)),t("span",{class:P([e.getStatusClass(e.loan.status),"px-2 py-0.5 inline-flex text-xs leading-5 font-semibold rounded-full"])},r(e.getStatusLabel(e.loan.status)),3)]),t("div",null,[s[20]||(s[20]=t("p",{class:"text-xs text-gray-500"},"Client",-1)),t("p",At,r(e.clientName),1)]),t("div",null,[s[21]||(s[21]=t("p",{class:"text-xs text-gray-500"},"Montant",-1)),t("p",zt,r(e.formatCurrency(e.loan.amount)),1)]),t("div",null,[s[22]||(s[22]=t("p",{class:"text-xs text-gray-500"},"Taux d'intérêt",-1)),t("p",Et,r(e.loan.interest_rate)+"%",1)]),t("div",null,[s[23]||(s[23]=t("p",{class:"text-xs text-gray-500"},"Durée",-1)),t("p",St,r(e.loan.term_months)+" mois",1)]),t("div",null,[s[24]||(s[24]=t("p",{class:"text-xs text-gray-500"},"Date de début",-1)),t("p",Vt,r(e.formatDate(e.loan.start_date)),1)]),t("div",null,[s[25]||(s[25]=t("p",{class:"text-xs text-gray-500"},"Date de fin",-1)),t("p",Nt,r(e.formatDate(e.loan.end_date)),1)]),t("div",null,[s[26]||(s[26]=t("p",{class:"text-xs text-gray-500"},"Garantie",-1)),t("p",qt,r(e.loan.collateral_description||"N/A"),1)]),t("div",null,[s[27]||(s[27]=t("p",{class:"text-xs text-gray-500"},"Valeur de la garantie",-1)),t("p",Bt,r(e.loan.collateral_value?e.formatCurrency(e.loan.collateral_value):"N/A"),1)]),t("div",null,[s[28]||(s[28]=t("p",{class:"text-xs text-gray-500"},"Créé le",-1)),t("p",jt,r(e.formatDate(e.loan.created_at)),1)]),t("div",null,[s[29]||(s[29]=t("p",{class:"text-xs text-gray-500"},"Approuvé par",-1)),t("p",Tt,r(e.loan.approver?`${e.loan.approver.name}`:"N/A"),1)])])]),t("div",Ft,[s[38]||(s[38]=t("h2",{class:"text-xs text-gray-700 font-medium mb-3"},"Statistiques du prêt",-1)),t("div",It,[s[31]||(s[31]=t("p",{class:"text-xs text-gray-500 mb-1"},"Progression du remboursement",-1)),t("div",Ht,[t("div",{class:"h-3 bg-primary rounded-full",style:mt({width:`${e.stats.progress}%`})},null,4)]),t("p",Ut,r(e.stats.progress)+"%",1)]),t("div",Xt,[t("div",null,[s[32]||(s[32]=t("p",{class:"text-xs text-gray-500"},"Montant total à rembourser",-1)),t("p",Ot,r(e.formatCurrency(e.stats.total_amount)),1)]),t("div",null,[s[33]||(s[33]=t("p",{class:"text-xs text-gray-500"},"Montant remboursé",-1)),t("p",Gt,r(e.formatCurrency(e.stats.paid_amount)),1)]),t("div",null,[s[34]||(s[34]=t("p",{class:"text-xs text-gray-500"},"Reste à rembourser",-1)),t("p",Jt,r(e.formatCurrency(e.stats.remaining_amount)),1)]),t("div",null,[s[35]||(s[35]=t("p",{class:"text-xs text-gray-500"},"Échéances payées",-1)),t("p",Kt,r(e.stats.paid_repayments)+" / "+r(e.stats.total_repayments),1)]),t("div",null,[s[36]||(s[36]=t("p",{class:"text-xs text-gray-500"},"Échéances restantes",-1)),t("p",Qt,r(e.stats.remaining_repayments),1)]),e.loan.status==="active"?(l(),o("div",Wt,[s[37]||(s[37]=t("p",{class:"text-xs text-gray-500"},"Jours restants",-1)),t("p",Yt,r(e.stats.days_remaining),1)])):y("",!0)])])]),t("div",Zt,[s[41]||(s[41]=t("h2",{class:"text-xs text-gray-700 font-medium mb-3"},"Échéancier de remboursement",-1)),e.loan.repayments&&e.loan.repayments.length>0?(l(),o("div",$t,[t("table",te,[s[40]||(s[40]=t("thead",{class:"bg-gray-50"},[t("tr",null,[t("th",{class:"py-3 px-4 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Échéance"),t("th",{class:"py-3 px-4 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Date d'échéance"),t("th",{class:"py-3 px-4 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Montant"),t("th",{class:"py-3 px-4 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Date de paiement"),t("th",{class:"py-3 px-4 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Pénalité"),t("th",{class:"py-3 px-4 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Statut"),t("th",{class:"py-3 px-4 text-center text-xs font-medium text-gray-500 uppercase tracking-wider w-12"},"Actions")])],-1)),t("tbody",ee,[(l(!0),o(N,null,q(e.paginatedRepayments,(n,d)=>(l(),o("tr",{key:n.id,class:"hover:bg-gray-50"},[t("td",se,[t("div",ae,r((e.currentRepaymentPage-1)*e.repaymentsPerPage+d+1),1)]),t("td",ne,[t("div",re,r(e.formatDate(n.due_date)),1)]),t("td",oe,[t("div",le,r(e.formatCurrency(n.amount)),1)]),t("td",ie,[t("div",de,r(n.payment_date?e.formatDate(n.payment_date):"-"),1)]),t("td",ce,[t("div",me,r(n.penalty_amount?e.formatCurrency(n.penalty_amount):"-"),1)]),t("td",ue,[t("span",{class:P([e.getRepaymentStatusClass(n.status),"px-2 inline-flex text-xs leading-5 font-medium rounded-lg"])},r(e.getRepaymentStatusLabel(n.status)),3)]),t("td",xe,[(n.status==="pending"||n.status==="late")&&e.loan.status==="active"?(l(),o("div",ye,[t("button",{onClick:b=>e.toggleActionMenu(n.id),class:"text-gray-500 hover:text-gray-700 focus:outline-none"},s[39]||(s[39]=[t("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor"},[t("path",{d:"M10 6a2 2 0 110-4 2 2 0 010 4zM10 12a2 2 0 110-4 2 2 0 010 4zM10 18a2 2 0 110-4 2 2 0 010 4z"})],-1)]),8,ge),e.activeActionMenu===n.id?(l(),o("div",pe,[t("a",{href:"#",onClick:j(b=>e.openPaymentModal(n),["prevent"]),class:"block px-4 py-2 text-xs text-gray-700 hover:bg-gray-100",role:"menuitem"}," Enregistrer un paiement ",8,fe),t("a",{href:"#",onClick:j(b=>e.markAsMissed(n),["prevent"]),class:"block px-4 py-2 text-xs text-red-600 hover:bg-gray-100",role:"menuitem"}," Marquer comme manqué ",8,ve)])):y("",!0)])):(l(),o("span",be,"—"))])]))),128))])]),t("div",we,[t("div",he," Affichage de "+r((e.currentRepaymentPage-1)*e.repaymentsPerPage+1)+" à "+r(Math.min(e.currentRepaymentPage*e.repaymentsPerPage,e.loan.repayments.length))+" sur "+r(e.loan.repayments.length)+" échéances ",1),t("div",_e,[t("button",{onClick:s[2]||(s[2]=n=>e.goToRepaymentPage(e.currentRepaymentPage-1)),disabled:e.currentRepaymentPage===1,class:P([e.currentRepaymentPage===1?"opacity-50 cursor-not-allowed":"","px-3 py-1 text-xs border border-gray-300 rounded-md hover:bg-gray-100"])}," Précédent ",10,ke),(l(!0),o(N,null,q(e.displayedRepaymentPages,n=>(l(),o("div",{key:n},[n!=="..."?(l(),o("button",{key:0,onClick:d=>e.goToRepaymentPage(n),class:P([e.currentRepaymentPage===n?"bg-primary text-white":"bg-white text-gray-700 hover:bg-gray-100","px-3 py-1 text-xs border border-gray-300 rounded-md"])},r(n),11,Pe)):(l(),o("span",Ce,r(n),1))]))),128)),t("button",{onClick:s[3]||(s[3]=n=>e.goToRepaymentPage(e.currentRepaymentPage+1)),disabled:e.currentRepaymentPage===e.totalRepaymentPages,class:P([e.currentRepaymentPage===e.totalRepaymentPages?"opacity-50 cursor-not-allowed":"","px-3 py-1 text-xs border border-gray-300 rounded-md hover:bg-gray-100"])}," Suivant ",10,Me)])])])):(l(),o("div",De," Aucune échéance de remboursement trouvée. "))])])),e.showPaymentModal?(l(),o("div",Re,[t("div",{class:"fixed inset-0 bg-black opacity-50",onClick:s[4]||(s[4]=n=>e.showPaymentModal=!1)}),t("div",Le,[s[53]||(s[53]=t("h3",{class:"text-xs font-medium text-gray-900 mb-3"},"Enregistrer un paiement",-1)),t("div",Ae,[t("div",ze,[s[42]||(s[42]=t("span",{class:"text-xs text-gray-600"},"Échéance",-1)),t("span",Ee,r(e.selectedRepaymentIndex+1),1)]),t("div",Se,[s[43]||(s[43]=t("span",{class:"text-xs text-gray-600"},"Date d'échéance",-1)),t("span",Ve,r(e.formatDate(e.selectedRepayment.due_date)),1)]),t("div",Ne,[s[44]||(s[44]=t("span",{class:"text-xs text-gray-600"},"Montant",-1)),t("span",qe,r(e.formatCurrency(e.selectedRepayment.amount)),1)]),e.isLatePayment?(l(),o("div",Be,[s[45]||(s[45]=t("span",{class:"text-xs text-gray-600"},"Pénalité (5%)",-1)),t("span",je,r(e.formatCurrency(e.calculatePenalty())),1)])):y("",!0),e.isLatePayment?(l(),o("div",Te,[s[46]||(s[46]=t("span",{class:"text-xs text-gray-600"},"Montant total",-1)),t("span",Fe,r(e.formatCurrency(e.selectedRepayment.amount+e.calculatePenalty())),1)])):y("",!0)]),t("div",Ie,[s[48]||(s[48]=t("label",{class:"block text-xs font-medium text-gray-700 mb-1"},"Méthode de paiement *",-1)),E(t("select",{"onUpdate:modelValue":s[5]||(s[5]=n=>e.paymentData.payment_method=n),required:"",disabled:"",class:"block w-full text-xs text-gray-600 py-1.5 px-3 border border-gray-300 bg-white rounded-md shadow-sm focus:outline-none focus:ring-primary focus:border-primary"},s[47]||(s[47]=[t("option",{value:"cash"},"Espèces",-1),t("option",{value:"mobile_money"},"Mobile Money",-1),t("option",{value:"bank_transfer"},"Virement bancaire",-1)]),512),[[ut,e.paymentData.payment_method]])]),t("div",He,[s[49]||(s[49]=t("label",{class:"block text-xs font-medium text-gray-700 mb-1"},"Référence de transaction",-1)),E(t("input",{type:"text",disabled:"","onUpdate:modelValue":s[6]||(s[6]=n=>e.paymentData.transaction_reference=n),class:"block w-full text-xs text-gray-600 py-1.5 px-3 border border-gray-300 bg-white rounded-md shadow-sm focus:outline-none focus:ring-primary focus:border-primary",placeholder:"N° de transaction, reçu, etc."},null,512),[[B,e.paymentData.transaction_reference]])]),e.isLatePayment?(l(),o("div",Ue,[s[50]||(s[50]=t("label",{class:"block text-xs font-medium text-gray-700 mb-1"},"Pénalité de retard (XAF)",-1)),E(t("input",{type:"number","onUpdate:modelValue":s[7]||(s[7]=n=>e.paymentData.penalty_amount=n),min:"0",class:"block w-full text-xs text-gray-600 py-1.5 px-3 border border-gray-300 bg-white rounded-md shadow-sm focus:outline-none focus:ring-primary focus:border-primary"},null,512),[[B,e.paymentData.penalty_amount,void 0,{number:!0}]]),s[51]||(s[51]=t("p",{class:"text-xs text-gray-500 mt-1"},"La pénalité par défaut est de 5% du montant de l'échéance.",-1))])):y("",!0),t("div",Xe,[t("button",{onClick:s[8]||(s[8]=n=>e.showPaymentModal=!1),class:"btn btn-secondary"}," Annuler "),t("button",{onClick:s[9]||(s[9]=(...n)=>e.recordPayment&&e.recordPayment(...n)),class:"btn btn-primary",disabled:v.savingPayment},[v.savingPayment?(l(),o("span",Ge,s[52]||(s[52]=[t("svg",{class:"animate-spin -ml-1 mr-2 h-3 w-3 text-white inline-block",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},[t("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"}),t("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})],-1),R(" Enregistrement... ")]))):(l(),o("span",Je,"Enregistrer le paiement"))],8,Oe)])])])):y("",!0),e.showDeleteModal?(l(),o("div",Ke,[t("div",{class:"fixed inset-0 bg-black opacity-50",onClick:s[10]||(s[10]=n=>e.showDeleteModal=!1)}),t("div",Qe,[s[55]||(s[55]=t("h3",{class:"text-sm font-semibold text-gray-900 mb-3"},"Confirmer la suppression",-1)),s[56]||(s[56]=t("p",{class:"text-xs text-gray-600 mb-4"},"Êtes-vous sûr de vouloir supprimer ce prêt ? Cette action est irréversible.",-1)),t("div",We,[t("button",{onClick:s[11]||(s[11]=n=>e.showDeleteModal=!1),class:"btn btn-secondary"}," Annuler "),t("button",{onClick:s[12]||(s[12]=(...n)=>v.confirmDelete&&v.confirmDelete(...n)),class:"btn btn-danger",disabled:e.deleting},[e.deleting?(l(),o("span",Ze,s[54]||(s[54]=[t("svg",{class:"animate-spin -ml-1 mr-2 h-3 w-3 text-white inline-block",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},[t("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"}),t("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})],-1),R(" Suppression... ")]))):(l(),o("span",$e,"Supprimer"))],8,Ye)])])])):y("",!0)])}const ss=ot(vt,[["render",ts],["__scopeId","data-v-14b8cf57"]]);export{ss as default};
